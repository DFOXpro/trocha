/** @license trocha@0.2.3 - 2019-05-09
* Trocha.js 
* 
* This source code is licensed under the Mozillas Public license 2.0 found in the 
* LICENSE file in the root directory of this source tree. 
*/

function _get(e,t,r){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(e){_defineProperty(t,e,r[e])})}return t}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classPrivateFieldGet(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");var r=t.get(e);return r.get?r.get.call(e):r.value}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _wrapNativeSuper(e){var r="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(e){if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,t)}function t(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(t,e)})(e)}function isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function _construct(e,t,r){return(_construct=isNativeReflectConstruct()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&_setPrototypeOf(i,r.prototype),i}).apply(null,arguments)}function _isNativeFunction(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e){var h=function(e,t,r){throw new(function(e){function i(e,t,r){var n;return _classCallCheck(this,i),(n=_possibleConstructorReturn(this,_getPrototypeOf(i).call(this,a+t))).scope=e,n.value=r,n}return _inherits(i,_wrapNativeSuper(Error)),i}())(e,t,r)},i=function(e,t,r){console.warn(l+t,r||g,e||g)},g="",P="id",S="name",O="hide",y="type",b="alias",F="query",G="post",w="method",C="domain",k="idMode",E="justId",T="fragment",R="resource",m="parentId",A="separator",j="defaultId",D="alwaysUrl",N="alwaysPost",U="firstSeparator",I="ROUTE",L="SCOPE",M="RESOURCE",H="ALIAS",W="SLASH",t="BACK_SLASH",x="_PREID",B={SLASH:{}};B[W][A]="/",B[W][U]=!0,B[t]={},B[t][A]="\\",B[t][U]=!1,B.DOT={},B.DOT[A]=".",B.DOT[U]=!1,B[void 0]={};var J="COLON",r="BRACKETS",n={};n[r]="{".concat("Ñ","}"),n[J]=":".concat("Ñ");var K=function(t){return function(e){return(1<arguments.length&&void 0!==arguments[1]?arguments[1]:"Ñ").replace("Ñ",n[t].replace("Ñ",e))}},o="list",$=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"$",t={};return t[e+P]=P,t.show={},t.edit={},t.new={},t[o]={},t.show[e+O]=!0,t.new[e+P]=!1,t[o][e+P]=!1,t[o][e+O]=!0,t},a="TrochaJS error: ",l="TrochaJS warning: ",Route=function(){function Route(e,t,r,n){var i=this,o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{},a=5<arguments.length?arguments[5]:void 0,l=6<arguments.length?arguments[6]:void 0,c=7<arguments.length?arguments[7]:void 0,s=8<arguments.length?arguments[8]:void 0,u=9<arguments.length?arguments[9]:void 0,f=10<arguments.length?arguments[10]:void 0,p=11<arguments.length?arguments[11]:void 0,d=12<arguments.length?arguments[12]:void 0;_classCallCheck(this,Route),z.set(this,{writable:!0,value:{parent:null,childs:{},SS:"$",alwaysPost:!1,alwaysUrl:!1,idMode:J,domain:"",post:"",pre:"",separator:B[W][A],firstSeparator:B[W][U]}}),q.set(this,{writable:!0,value:function(e,t){var r=_classPrivateFieldGet(e,z).SS;return!!_classPrivateFieldGet(e,z).parent&&(_classPrivateFieldGet(e,z).parent[r+P]===t||_classPrivateFieldGet(e,q).call(e,_classPrivateFieldGet(e,z).parent,t))}}),Q.set(this,{writable:!0,value:function(e,t,r,n){var i=n?"":_classPrivateFieldGet(e,z).SS;Object.defineProperty(e,i+t,{get:function(){return r?r():_classPrivateFieldGet(e,z)[t]},enumerable:!0,configurable:!1})}}),V.set(this,{writable:!0,value:function(t,r){var n=_classPrivateFieldGet(t,z).SS,e=function(e){_classPrivateFieldGet(t,z)[e]=r[n+e],delete r[n+e]};e(S),e(P),e(j),e(y),e(w),e(b),e(R),e(O),e(G),e(E),e(m),!1===r[_classPrivateFieldGet(t,z).parent[n+P]]&&e(_classPrivateFieldGet(t,z).parent[n+P]),_classPrivateFieldGet(t,Q).call(t,t,S),_classPrivateFieldGet(t,Q).call(t,t,P),_classPrivateFieldGet(t,Q).call(t,t,w),_classPrivateFieldGet(t,Q).call(t,t,"as",function(){return _classPrivateFieldGet(t,Z).call(t,t)})}}),X.set(this,{writable:!0,value:function(e,t,r){var n=_classPrivateFieldGet(e,z).SS;_classPrivateFieldGet(e,z).childs[r]&&h(e,"Route already declare",r),[Route,Alias,Resource,Scope].forEach(function(e){e.is(t,n)&&(t=e.diggest(t,n,n))}),t[n+S]=r;var i={};i[I]=Route,i[void 0]=Route,i[H]=Alias,i[L]=Scope,i[M]=Resource;var o=new i[t[n+y]](e,t,n,_classPrivateFieldGet(e,z).root);_classPrivateFieldGet(e,z).childs[r]=o,_classPrivateFieldGet(e,Q).call(e,e,r,function(){return _classPrivateFieldGet(e,z).childs[r]},!0)}}),Y.set(this,{writable:!0,value:function(e,t,r){var n=_classPrivateFieldGet(e,z).SS;if(!r&&_classPrivateFieldGet(e,z)[y]===M){var i=_classPrivateFieldGet(e,z)[R];delete i[n+P],_classPrivateFieldGet(e,Y).call(e,e,i,!0)}for(var o=Object.keys(t);o.length;){var a=o.pop();if(!1===t[a]&&_classPrivateFieldGet(e,q).call(e,e,a))_classPrivateFieldGet(e,z)[a]=!1;else if(_classPrivateFieldGet(e,X).call(e,e,t[a],a),_classPrivateFieldGet(e,z)[y]===L){var l=_objectSpread({},t[a]);l[n+m]=!1,_classPrivateFieldGet(e,X).call(e,_classPrivateFieldGet(e,z).parent,l,a)}}}}),Z.set(this,{writable:!0,value:function(e){var t=_classPrivateFieldGet(e,z).SS;return _classPrivateFieldGet(e,z).parent[t+"as"]?"".concat(_classPrivateFieldGet(e,z).parent[t+"as"],"_").concat(_classPrivateFieldGet(e,z)[S]):_classPrivateFieldGet(e,z)[S]}}),_defineProperty(this,"_newRoute",function(e){if(e[y]=I,!Route.is(e,""))return!1;_classPrivateFieldGet(i,X).call(i,i,Route.diggest(e,_classPrivateFieldGet(i,z).SS,""),e[S])}),_defineProperty(this,"_newScope",function(e){if(e[y]=L,!Scope.is(e,""))return!1;_classPrivateFieldGet(i,X).call(i,i,Scope.diggest(e,_classPrivateFieldGet(i,z).SS,""),e[S])}),_defineProperty(this,"_newAlias",function(e){if(e[y]=H,!Alias.is(e,""))return!1;_classPrivateFieldGet(i,X).call(i,i,Alias.diggest(e,_classPrivateFieldGet(i,z).SS,""),e[S])}),_defineProperty(this,"_newResource",function(e){if(e[y]=M,!Resource.is(e,""))return!1;_classPrivateFieldGet(i,X).call(i,i,Resource.diggest(e,_classPrivateFieldGet(i,z).SS,""),e[S])}),_defineProperty(this,"toString",function(){return _classPrivateFieldGet(i,Z).call(i,i)});var v=_classPrivateFieldGet(this,z).SS=r||"$";if(e||t&&t[v+S]&&t[v+y])_classPrivateFieldGet(this,z).parent=e,_classPrivateFieldGet(this,z).root=n,_classPrivateFieldGet(this,V).call(this,this,t),_classPrivateFieldGet(this,Y).call(this,this,t);else{var _=function(e,t){return _classPrivateFieldGet(i,z)[e]=void 0!==t?t:_classPrivateFieldGet(i,z)[e]};_(C,a),_classPrivateFieldGet(this,Q).call(this,this,C),_(D,l),_(N,u),_(G,s),_("pre",c),_(k,f),_(A,B[p][A]),_(U,void 0!==d?d:B[p][U]),_(x,_classPrivateFieldGet(this,z)[A]+"Ñ"),_classPrivateFieldGet(this,z).root=_classPrivateFieldGet(this,z),delete this.path,_classPrivateFieldGet(this,Q).call(this,this,M,function(){return $(v)}),_classPrivateFieldGet(this,Y).call(this,this,o)}}return _createClass(Route,[{key:"path",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=1<arguments.length?arguments[1]:void 0,r=_classPrivateFieldGet(this,z),n=r.parent||{},i=r.root,o=r.SS,a=!!n[o+C],l=K(i[k]),c=g;if(void 0===r[S])return"";c=i[C]&&a&&!1!==t.url&&(t.url||i[D])?i[C]:g,c+=i.pre&&(t.pre||t.ext)?i.pre:g,delete t.pre;var s={};s.url=t.url;var u=n.path(s,function(){return!0}),f=u||i[U]?i[A]:g;s[G]=!1,c+=u,delete t.url;var p,d=void 0!==t[O]?t[O]:r[O]||r[E]&&!1===r[j];if("function"==typeof e&&(p=e(r,f)),"string"==typeof p)c+=p;else{var v=l(r.id);if(!1!==t[E]&&r[E]&&r.id&&!1!==r[r.id])c+=f+v;else{var _=!r.id||!1===t.id;c+=d?g:f+r[S],c+=_?g:i[A]+v}}c+=i[G]&&!d&&!1!==t[G]&&(i[N]||r[G]||t[G]||t.ext)?i[G]:g,delete t[G];var h={};t[F]&&(h=JSON.parse(JSON.stringify(t[F])),delete t[F]);var y=g;return t[T]&&(y=t[T],delete t[T]),!n[o+P]||t[n[o+P]]||!1!==r.id&&!1!==t[m]&&!1!==r[m]||(c=c.replace(l(n[o+P],i[x]),g)),Object.keys(r).forEach(function(e){if(!1===r[e]&&!t[e])return c=c.replace(l(e,i[x]),g)}),Object.keys(t).forEach(function(e){c=!1===t[e]?c.replace(l(e,i[x]),g):c.replace(l(e),t[e])}),Object.keys(h).forEach(function(r,n,i){0===n&&(c+="?"),Array.isArray(h[r])?h[r].forEach(function(e,t){return c+=encodeURIComponent(r)+"[]="+encodeURIComponent(e)+(h[r].length-1!==t||i.length-1!==n?"&":"")}):c+=encodeURIComponent(r)+"="+encodeURIComponent(h[r])+(i.length-1!==n?"&":"")}),y&&(c+="#"+encodeURIComponent(y)),c}}],[{key:"is",value:function(e,t){return e[t+y]===I||"object"===_typeof(e)&&void 0===e[t+y]}}]),Route}(),z=new WeakMap,q=new WeakMap,Q=new WeakMap,V=new WeakMap,X=new WeakMap,Y=new WeakMap,Z=new WeakMap;_defineProperty(Route,"DEFAULT_METHOD","GET"),_defineProperty(Route,"diggest",function(t,r,n,i,e){if(!i||!e){var o={};return o[r+y]=I,o[r+w]=t[n+w]||Route.DEFAULT_METHOD,Route.diggest(t,r,n,o,[P,O,E,G,m]),Route._trimSelector(n,t,o),o}e.forEach(function(e){i[r+e]=t[n+e]})}),_defineProperty(Route,"_trimSelector",function(t,r,n){""!==t&&Object.keys(r).forEach(function(e){e.slice(0,2)!==t?n[e]=r[e]:i(Route,"Attribute not supported, skiped",e)})});var Alias=function(e){function Alias(){var e;_classCallCheck(this,Alias);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return _possibleConstructorReturn(this,(e=_getPrototypeOf(Alias)).call.apply(e,[this].concat(r)))}return _inherits(Alias,Route),_createClass(Alias,[{key:"path",value:function(){var l=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return _get(_getPrototypeOf(Alias.prototype),"path",this).call(this,l,function(e,t){var r=e.parent||{},n=e.root,i=K(n[k])(e.id,n[x]),o=g;if(e.id&&l[E])o+=i;else{var a=!!e.id&&!1!==l[e.id];o+="Trocha"===r.constructor.name?g:t,o+=l[O]?g:e[b],o+=a?i:g}return o})}}],[{key:"diggest",value:function(e,t,r){var n={};return n[t+y]=H,n[t+b]=e[r+b]||e,n[t+w]=e[r+w]||Route.DEFAULT_METHOD,Route.diggest(e,t,r,n,[P,G,m]),"string"!=typeof e&&Route._trimSelector(r,e,n),n}},{key:"is",value:function(e,t){return"string"==typeof e||e[t+y]===H&&e[t+b]}}]),Alias}(),Resource=function(e){function Resource(){var e;_classCallCheck(this,Resource);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return _possibleConstructorReturn(this,(e=_getPrototypeOf(Resource)).call.apply(e,[this].concat(r)))}return _inherits(Resource,Route),_createClass(Resource,[{key:"path",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=1<arguments.length?arguments[1]:void 0;return _get(_getPrototypeOf(Resource.prototype),"path",this).call(this,e,function(e,t){return"function"==typeof r&&!0!==r()&&i(void 0,"Resource should not be used as a route"),!1})}}],[{key:"diggest",value:function(e,t,r){var n={};return n[t+y]=M,n[t+R]=e[r+R]||$(t),Route.diggest(e,t,r,n,[P]),Route._trimSelector(r,e,n),n}},{key:"is",value:function(e,t){return e[t+y]===M&&e[t+P]}}]),Resource}(),Scope=function(e){function Scope(){var e;_classCallCheck(this,Scope);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return _possibleConstructorReturn(this,(e=_getPrototypeOf(Scope)).call.apply(e,[this].concat(r)))}return _inherits(Scope,Route),_createClass(Scope,[{key:"path",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=1<arguments.length?arguments[1]:void 0;return _get(_getPrototypeOf(Scope.prototype),"path",this).call(this,e,function(e,t){return"function"==typeof r&&!0!==r()&&h(void 0,"Scope is not printable a route"),!1})}}],[{key:"diggest",value:function(e,t,r){var n={};return n[t+y]=L,n[t+E]=!0,n[t+j]=e[r+j]||!1,Route.diggest(e,t,r,n,[P,O]),Route._trimSelector(r,e,n),n}},{key:"is",value:function(e,t){return"object"===_typeof(e)&&e[t+y]===L&&e[t+P]}}]),Scope}(),Trocha=function(e){function Trocha(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,Trocha),_possibleConstructorReturn(this,_getPrototypeOf(Trocha).call(this,null,null,e.customSelector,null,e.routes,e[C],e[D],e.pre,e[G],e[N],e[k],e[A],e[U]))}return _inherits(Trocha,Route),_createClass(Trocha,null,[{key:"ROUTE",get:function(){return I}},{key:"SCOPE",get:function(){return L}},{key:"RESOURCE",get:function(){return M}},{key:"ALIAS",get:function(){return H}},{key:"OPTIONS",get:function(){return"OPTIONS"}},{key:"GET",get:function(){return"GET"}},{key:"HEAD",get:function(){return"HEAD"}},{key:"POST",get:function(){return"POST"}},{key:"PUT",get:function(){return"PUT"}},{key:"PATCH",get:function(){return"PATCH"}},{key:"DELETE",get:function(){return"DELETE"}},{key:"TRACE",get:function(){return"TRACE"}},{key:"CONNECT",get:function(){return"CONNECT"}},{key:"COLON",get:function(){return J}},{key:"BRACKETS",get:function(){return r}},{key:"$RESOURCE",get:function(){return $()}},{key:"SLASH",get:function(){return W}},{key:"BACK_SLASH",get:function(){return t}},{key:"DOT",get:function(){return"DOT"}}]),Trocha}();e.Trocha=Trocha,e.Route=Route,e.Alias=Alias,e.Resource=Resource,e.Scope=Scope}(this);