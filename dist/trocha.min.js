/*! Trocha.js - v0.1.1 - 2017-01-06 */this.trocha=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa;return V="/",_="",a="$",G="OPTIONS",w="GET",x="HEAD",K="POST",N="PUT",I="PATCH",t="DELETE",S="TRACE",q="CONNECT",P="ROUTE",R="SCOPE",O="RESOURCE",z="id",C="name",y="hide",U="url",T="type",M="pre",m="alias",L="post",v="ext",B="method",u="domain",Q="routes",A="justId",l="afterId",H="parentId",o="alwaysUrl",n="alwaysPost",s="customSelector",p=a+"as",b=a+z,J="path",d=a+C,c=a+B,r="_custom",F="_newScope",E="_newRoute",D="_newResource",h=a+u,j=a+M,i=a+L,f=a+o,e=a+n,k=a+O.toLowerCase(),g=a+s,$="show",X="edit",Z="new",Y="list",W={},W[a+z]=z,W[$]={},W[X]={},W[Z]={},W[Y]={},W[$][a+y]=!0,W[Z][a+z]=!1,W[Y][a+z]=!1,W[Y][a+y]=!0,aa=function(q){var t,x,G,I,K,N,P,S;return q||(q={}),S={},t=function(a){return a[u]&&(S[h]=_+a[u]),a[M]&&(S[j]=_+a[M]),a[L]&&(S[i]=_+a[L]),a[O.toLowerCase()]&&(S[k]=a[O.toLowerCase()]),a[s]&&(S[g]=a[s]),a[o]&&(S[f]=a[o]),a[n]&&(S[e]=a[n]),S[F]=P,S[E]=N,S[D]=K,S[r]=function(a,b){return x({},a)(b)},a[Q]&&G(S,a[Q]),S},G=function(b,c,d){var e,f;return e=d||S[g]||a,delete c[e+T],f=Object.keys(c),f.forEach(function(a){var d,f,g,h;if(h=c[a],"string"==typeof h)return b[a]=h;if("object"==typeof h)return h[e+T]===R?(g={},g[C]=a,void 0!==h[e+z]&&(g[z]=h[e+z],delete h[e+z]),b[F](g)):h[e+T]===O?(d={},d[C]=a,void 0!==h[e+z]&&(d[z]=h[e+z],delete h[e+z]),b[D](d)):(f={},f[C]=a,void 0!==h[e+z]&&(f[z]=h[e+z],delete h[e+z]),h[e+B]&&(f[B]=h[e+B],delete h[e+B]),h[e+A]&&(f[A]=h[e+A],delete h[e+A]),h[e+l]&&(f[l]=h[e+l],delete h[e+l]),h[e+y]&&(f[y]=h[e+y],delete h[e+y]),h[e+L]&&(f[L]=h[e+L],delete h[e+L]),b[E](f)),G(b[a],h);throw"TrochaJS error: [_prepareRoutes] invalid route definition. "+C+" = "+a+" in "+b[C]})},x=function(a,c){return function(d){var g,k,l,n,o;return d||(d={}),c[m]?c[m]:(o=S[h]&&!a[J]&&(d[U]||S[f])?S[h]:_,delete d[U],o+=(d[M]||d[v])&&S[j]?S[j]:_,delete d[M],o+=a[J]?a[J]({post:!1}):_,k=void 0!==d[y]?d[y]:c[y],(a[b]&&c[z]===!1&&!d[z]||d[H]===!1)&&(o=o.replace("/:"+a[b],_)),d[A]!==!1&&c[A]&&c[z]?o+=V+":"+c[z]:(l=!c[z]||d[z]===!1,o+=k?_:V+c[C],o+=l?_:V+":"+c[z]),o+=S[i]&&0!=d[L]&&!k&&(S[e]||c[L]||d[L]||d[v])?S[i]:_,delete d[L],n=g={},d.query&&(n=JSON.parse(JSON.stringify(d.query)),delete d.query),d.fragment&&(g=JSON.parse(JSON.stringify(d.fragment))),delete d.fragment,Object.keys(d).forEach(function(a){return o=d[a]===!1?o.replace("/:"+a,_):o.replace(":"+a,d[a])}),Object.keys(n).forEach(function(a,b,c){return 0===b&&(o+="?"),o+=encodeURIComponent(a)+"="+encodeURIComponent(n[a])+(c.length-1!==b?"&":"")}),o)}},I=function(a,b){var c;return c=a[p],(c?c+"_":"")+b[C]},P=function(a){var b,c;if(a){if(a[C]){if("string"!=typeof a[C])throw"Trocha.newScope: require String name";return b=this,c={},c[d]=a[C],c[J]=x(b,a),c[p]=I(b,a),c[E]=N,c[D]=K,b[c[d]]=c}throw"Trocha.newScope: Missing name"}},N=function(a){var e,f;if(e=this,a){if(a[C]){if("string"!=typeof a[C])throw"Trocha.newRoute: require String "+C;if(a[m]){if("string"!=typeof a[m])throw"Trocha.newRoute: require String "+m;return e[a[C]]=a[m]}return f={},f[c]=a[B]||w,f[d]=a[C],f[E]=N,f[D]=K,f[F]=P,f[J]=x(e,a),f[p]=I(e,a),a[z]&&(f[b]=a[z]),e[f[d]]=f}throw"Trocha.newRoute: Missing "+C}},K=function(b){var c,d;if(b){if("object"!=typeof b)throw"Trocha.newRoute: require Object input";return c={},b[O.toLowerCase()]||S[k]?(c[b[C]]=JSON.parse(JSON.stringify(b[O.toLowerCase()]||S[k])),d=S[g]||a):(c[b[C]]=JSON.parse(JSON.stringify(W)),d=a),c[b[C]][a+z]=b[z],G(this,c,d)}},t(q)},aa.OPTIONS=G,aa.GET=w,aa.HEAD=x,aa.POST=K,aa.PUT=N,aa.PATCH=I,aa.DELETE=t,aa.TRACE=S,aa.CONNECT=q,aa[O]=O,aa[P]=P,aa[R]=R,aa[a+O]=JSON.parse(JSON.stringify(W)),aa}();