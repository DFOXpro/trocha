/*! Trocha.js - v0.1.1 - 2016-08-22 */this.trocha=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$;return T="/",Z="",a="$",E="OPTIONS",u="GET",v="HEAD",I="POST",L="PUT",G="PATCH",r="DELETE",Q="TRACE",o="CONNECT",N="ROUTE",P="SCOPE",M="RESOURCE",x="id",A="name",w="hide",S="url",R="type",K="pre",l="alias",J="post",t="ext",z="method",s="domain",O="routes",y="justId",k="afterId",F="parentId",m="alwaysUrl",q="customSelector",n=a+"as",b=a+x,H="path",d=a+A,c=a+z,p="_custom",D="_newScope",C="_newRoute",B="_newResource",g=a+s,i=a+K,h=a+J,e=a+m,j=a+M.toLowerCase(),f=a+q,Y="show",V="edit",X="new",W="list",U={},U[a+x]=x,U[Y]={},U[V]={},U[X]={},U[W]={},U[Y][a+w]=!0,U[X][a+x]=!1,U[W][a+x]=!1,U[W][a+w]=!0,$=function(o){var r,v,E,G,I,L,N,Q;return Q={},r=function(a){return a[s]&&(Q[g]=Z+a[s]),a[K]&&(Q[i]=Z+a[K]),a[J]&&(Q[h]=Z+a[J]),a[M.toLowerCase()]&&(Q[j]=a[M.toLowerCase()]),a[q]&&(Q[f]=a[q]),a[m]&&(Q[e]=a[m]),Q[D]=N,Q[C]=L,Q[B]=I,Q[p]=function(a,b){return v({},a)(b)},a[O]&&E(Q,a[O]),Q},E=function(b,c,d){var e,g;return e=d||Q[f]||a,delete c[e+R],g=Object.keys(c),g.forEach(function(a){var d,f,g,h;if(h=c[a],"string"==typeof h)return b[a]=h;if("object"==typeof h)return h[e+R]===P?(g={},g[A]=a,void 0!==h[e+x]&&(g[x]=h[e+x],delete h[e+x]),b[D](g)):h[e+R]===M?(d={},d[A]=a,void 0!==h[e+x]&&(d[x]=h[e+x],delete h[e+x]),b[B](d)):(f={},f[A]=a,void 0!==h[e+x]&&(f[x]=h[e+x],delete h[e+x]),h[e+z]&&(f[z]=h[e+z],delete h[e+z]),h[e+y]&&(f[y]=h[e+y],delete h[e+y]),h[e+k]&&(f[k]=h[e+k],delete h[e+k]),h[e+w]&&(f[w]=h[e+w],delete h[e+w]),b[C](f)),E(b[a],h);throw"TrochaJS error: [_prepareRoutes] invalid route definition. name = "+a})},v=function(a,c){return function(d){var f,j,k,m,n;return d||(d={}),c[l]?c[l]:(n=Q[g]&&!a[H]&&(d[S]||Q[e])?Q[g]:Z,delete d[S],n+=(d[K]||d[t])&&Q[i]?Q[i]:Z,delete d[K],n+=(a[H]?a[H]():Z)+T,(a[b]&&c[x]===!1&&!d[x]||d[F]===!1)&&(n=n.replace("/:"+a[b],Z)),d[y]!==!1&&c[y]&&c[x]?n+=T+":"+c[x]:(j=void 0!==d[w]?d[w]:c[w],k=!c[x]||d[x]===!1,n+=j?Z:c[A],n+=k?Z:T+":"+c[x]),n+=(d[J]||d[t])&&Q[h]?Q[h]:Z,delete d[J],m=f={},d.query&&(m=JSON.parse(JSON.stringify(d.query)),delete d.query),d.fragment&&(f=JSON.parse(JSON.stringify(d.fragment))),delete d.fragment,Object.keys(d).forEach(function(a){return n=d[a]===!1?n.replace("/:"+a,Z):n.replace(":"+a,d[a])}),Object.keys(m).forEach(function(a,b,c){return 0===b&&(n+="?"),n+=encodeURIComponent(a)+"="+encodeURIComponent(m[a])+(c.length-1!==b?"&":"")}),n)}},G=function(a,b){var c;return c=a[n],(c?c+"_":"")+b[A]},N=function(a){var b,c;if(a){if(a[A]){if("string"!=typeof a[A])throw"Trocha.newScope: require String name";return b=this,c={},c[d]=a[A],c[H]=v(b,a),c[n]=G(b,a),c[C]=L,c[B]=I,b[c[d]]=c}throw"Trocha.newScope: Missing name"}},L=function(a){var e,f;if(e=this,a){if(a[A]){if("string"!=typeof a[A])throw"Trocha.newRoute: require String "+A;if(a[l]){if("string"!=typeof a[l])throw"Trocha.newRoute: require String "+l;return e[a[A]]=a[l]}return f={},f[c]=a[z]||u,f[d]=a[A],f[C]=L,f[B]=I,f[D]=N,f[H]=v(e,a),f[n]=G(e,a),a[x]&&(f[b]=a[x]),e[f[d]]=f}throw"Trocha.newRoute: Missing "+A}},I=function(b){var c,d;if(b){if("object"!=typeof b)throw"Trocha.newRoute: require Object input";return c={},b[M.toLowerCase()]||Q[j]?(c[b[A]]=JSON.parse(JSON.stringify(b[M.toLowerCase()]||Q[j])),d=Q[f]||a):(c[b[A]]=JSON.parse(JSON.stringify(U)),d=a),c[b[A]][a+x]=b[x],E(this,c,d)}},r(o)},$.OPTIONS=E,$.GET=u,$.HEAD=v,$.POST=I,$.PUT=L,$.PATCH=G,$.DELETE=r,$.TRACE=Q,$.CONNECT=o,$[M]=M,$[N]=N,$[P]=P,$[a+M]=JSON.parse(JSON.stringify(U)),$}();