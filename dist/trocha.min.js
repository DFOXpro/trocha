/*! Trocha.js - v0.1.1 - 2016-08-22 */this.trocha=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X;return Q="/",W="",a="$",B="OPTIONS",r="GET",s="HEAD",F="POST",I="PUT",D="PATCH",o="DELETE",N="TRACE",l="CONNECT",K="ROUTE",M="SCOPE",J="RESOURCE",u="id",x="name",t="hide",P="url",O="type",H="pre",G="post",q="ext",w="method",p="domain",L="routes",v="justId",j="afterId",C="parentId",n="customSelector",k=a+"as",b=a+u,E="path",d=a+x,c=a+w,m="_custom",A="_newScope",z="_newRoute",y="_newResource",f=a+p,h=a+H,g=a+G,i=a+J.toLowerCase(),e=a+n,V="show",S="edit",U="new",T="list",R={},R[a+u]=u,R[V]={},R[S]={},R[U]={},R[T]={},R[V][a+t]=!0,R[U][a+u]=!1,R[T][a+u]=!1,R[T][a+t]=!0,X=function(l){var o,s,B,D,F,I,K,N;return N={},o=function(a){return a[p]&&(N[f]=W+a[p]),a[H]&&(N[h]=W+a[H]),a[G]&&(N[g]=W+a[G]),a[J.toLowerCase()]&&(N[i]=a[J.toLowerCase()]),a[n]&&(N[e]=a[n]),N[A]=K,N[z]=I,N[y]=F,N[m]=function(a,b){return s({},a)(b)},a[L]&&B(N,a[L]),N},B=function(b,c,d){var f,g;return f=d||N[e]||a,delete c[f+O],g=Object.keys(c),g.forEach(function(a){var d,e,g,h;if(h=c[a],"object"!=typeof h)throw"TrochaJS error: [_prepareRoutes] invalid route definition. name = "+a;return h[f+O]===M?(g={},g[x]=a,void 0!==h[f+u]&&(g[u]=h[f+u],delete h[f+u]),b[A](g)):h[f+O]===J?(d={},d[x]=a,void 0!==h[f+u]&&(d[u]=h[f+u],delete h[f+u]),b[y](d)):(e={},e[x]=a,void 0!==h[f+u]&&(e[u]=h[f+u],delete h[f+u]),h[f+w]&&(e[w]=h[f+w],delete h[f+w]),h[f+v]&&(e[v]=h[f+v],delete h[f+v]),h[f+j]&&(e[j]=h[f+j],delete h[f+j]),h[f+t]&&(e[t]=h[f+t],delete h[f+t]),b[z](e)),B(b[a],h)})},s=function(a,c){return function(d){var e,i,j,k,l;return d||(d={}),l=d[P]&&N[f]?N[f]:W,delete d[P],l+=(d[H]||d[q])&&N[h]?N[h]:W,delete d[H],l+=(a[E]?a[E]():W)+Q,(a[b]&&c[u]===!1&&!d[u]||d[C]===!1)&&(l=l.replace("/:"+a[b],W)),d[v]!==!1&&c[v]&&c[u]?l+=Q+":"+c[u]:(i=void 0!==d[t]?d[t]:c[t],j=!c[u]||d[u]===!1,l+=i?W:c[x],l+=j?W:Q+":"+c[u]),l+=(d[G]||d[q])&&N[g]?N[g]:W,delete d[G],k=e={},d.query&&(k=JSON.parse(JSON.stringify(d.query)),delete d.query),d.fragment&&(e=JSON.parse(JSON.stringify(d.fragment))),delete d.fragment,Object.keys(d).forEach(function(a){return l=d[a]===!1?l.replace("/:"+a,W):l.replace(":"+a,d[a])}),Object.keys(k).forEach(function(a,b,c){return 0===b&&(l+="?"),l+=encodeURIComponent(a)+"="+encodeURIComponent(k[a])+(c.length-1!==b?"&":"")}),l}},D=function(a,b){var c;return c=a[k],(c?c+"_":"")+b[x]},K=function(a){var b,c;if(a){if(a[x]){if("string"!=typeof a[x])throw"Trocha.newScope: require String name";return b=this,c={},c[d]=a[x],c[E]=s(b,a),c[k]=D(b,a),c[z]=I,c[y]=F,b[c[d]]=c}throw"Trocha.newScope: Missing name"}},I=function(a){var e,f;if(a){if(a[x]){if("string"!=typeof a[x])throw"Trocha.newRoute: require String name";return e=this,f={},f[c]=a[w]||r,f[d]=a[x],f[z]=I,f[y]=F,f[A]=K,f[E]=s(e,a),f[k]=D(e,a),a[u]&&(f[b]=a[u]),e[f[d]]=f}throw"Trocha.newRoute: Missing name"}},F=function(b){var c,d;if(b){if("object"!=typeof b)throw"Trocha.newRoute: require Object input";return c={},b[J.toLowerCase()]||N[i]?(c[b[x]]=JSON.parse(JSON.stringify(b[J.toLowerCase()]||N[i])),d=N[e]||a):(c[b[x]]=JSON.parse(JSON.stringify(R)),d=a),c[b[x]][a+u]=b[u],B(this,c,d)}},o(l)},X.OPTIONS=B,X.GET=r,X.HEAD=s,X.POST=F,X.PUT=I,X.PATCH=D,X.DELETE=o,X.TRACE=N,X.CONNECT=l,X[J]=J,X[K]=K,X[M]=M,X[a+J]=JSON.parse(JSON.stringify(R)),X}();