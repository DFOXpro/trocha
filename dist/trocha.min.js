/*! Trocha.js - v0.1.1 - 2016-08-22 */this.trocha=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z;return S="/",Y="",a="$",D="OPTIONS",t="GET",u="HEAD",H="POST",K="PUT",F="PATCH",q="DELETE",P="TRACE",n="CONNECT",M="ROUTE",O="SCOPE",L="RESOURCE",w="id",z="name",v="hide",R="url",Q="type",J="pre",I="post",s="ext",y="method",r="domain",N="routes",x="justId",k="afterId",E="parentId",l="alwaysUrl",p="customSelector",m=a+"as",b=a+w,G="path",d=a+z,c=a+y,o="_custom",C="_newScope",B="_newRoute",A="_newResource",g=a+r,i=a+J,h=a+I,e=a+l,j=a+L.toLowerCase(),f=a+p,X="show",U="edit",W="new",V="list",T={},T[a+w]=w,T[X]={},T[U]={},T[W]={},T[V]={},T[X][a+v]=!0,T[W][a+w]=!1,T[V][a+w]=!1,T[V][a+v]=!0,Z=function(n){var q,u,D,F,H,K,M,P;return P={},q=function(a){return a[r]&&(P[g]=Y+a[r]),a[J]&&(P[i]=Y+a[J]),a[I]&&(P[h]=Y+a[I]),a[L.toLowerCase()]&&(P[j]=a[L.toLowerCase()]),a[p]&&(P[f]=a[p]),a[l]&&(P[e]=a[l]),P[C]=M,P[B]=K,P[A]=H,P[o]=function(a,b){return u({},a)(b)},a[N]&&D(P,a[N]),P},D=function(b,c,d){var e,g;return e=d||P[f]||a,delete c[e+Q],g=Object.keys(c),g.forEach(function(a){var d,f,g,h;if(h=c[a],"object"!=typeof h)throw"TrochaJS error: [_prepareRoutes] invalid route definition. name = "+a;return h[e+Q]===O?(g={},g[z]=a,void 0!==h[e+w]&&(g[w]=h[e+w],delete h[e+w]),b[C](g)):h[e+Q]===L?(d={},d[z]=a,void 0!==h[e+w]&&(d[w]=h[e+w],delete h[e+w]),b[A](d)):(f={},f[z]=a,void 0!==h[e+w]&&(f[w]=h[e+w],delete h[e+w]),h[e+y]&&(f[y]=h[e+y],delete h[e+y]),h[e+x]&&(f[x]=h[e+x],delete h[e+x]),h[e+k]&&(f[k]=h[e+k],delete h[e+k]),h[e+v]&&(f[v]=h[e+v],delete h[e+v]),b[B](f)),D(b[a],h)})},u=function(a,c){return function(d){var f,j,k,l,m;return d||(d={}),m=P[g]&&!a[G]&&(d[R]||P[e])?P[g]:Y,delete d[R],m+=(d[J]||d[s])&&P[i]?P[i]:Y,delete d[J],m+=(a[G]?a[G]():Y)+S,(a[b]&&c[w]===!1&&!d[w]||d[E]===!1)&&(m=m.replace("/:"+a[b],Y)),d[x]!==!1&&c[x]&&c[w]?m+=S+":"+c[w]:(j=void 0!==d[v]?d[v]:c[v],k=!c[w]||d[w]===!1,m+=j?Y:c[z],m+=k?Y:S+":"+c[w]),m+=(d[I]||d[s])&&P[h]?P[h]:Y,delete d[I],l=f={},d.query&&(l=JSON.parse(JSON.stringify(d.query)),delete d.query),d.fragment&&(f=JSON.parse(JSON.stringify(d.fragment))),delete d.fragment,Object.keys(d).forEach(function(a){return m=d[a]===!1?m.replace("/:"+a,Y):m.replace(":"+a,d[a])}),Object.keys(l).forEach(function(a,b,c){return 0===b&&(m+="?"),m+=encodeURIComponent(a)+"="+encodeURIComponent(l[a])+(c.length-1!==b?"&":"")}),m}},F=function(a,b){var c;return c=a[m],(c?c+"_":"")+b[z]},M=function(a){var b,c;if(a){if(a[z]){if("string"!=typeof a[z])throw"Trocha.newScope: require String name";return b=this,c={},c[d]=a[z],c[G]=u(b,a),c[m]=F(b,a),c[B]=K,c[A]=H,b[c[d]]=c}throw"Trocha.newScope: Missing name"}},K=function(a){var e,f;if(a){if(a[z]){if("string"!=typeof a[z])throw"Trocha.newRoute: require String name";return e=this,f={},f[c]=a[y]||t,f[d]=a[z],f[B]=K,f[A]=H,f[C]=M,f[G]=u(e,a),f[m]=F(e,a),a[w]&&(f[b]=a[w]),e[f[d]]=f}throw"Trocha.newRoute: Missing name"}},H=function(b){var c,d;if(b){if("object"!=typeof b)throw"Trocha.newRoute: require Object input";return c={},b[L.toLowerCase()]||P[j]?(c[b[z]]=JSON.parse(JSON.stringify(b[L.toLowerCase()]||P[j])),d=P[f]||a):(c[b[z]]=JSON.parse(JSON.stringify(T)),d=a),c[b[z]][a+w]=b[w],D(this,c,d)}},q(n)},Z.OPTIONS=D,Z.GET=t,Z.HEAD=u,Z.POST=H,Z.PUT=K,Z.PATCH=F,Z.DELETE=q,Z.TRACE=P,Z.CONNECT=n,Z[L]=L,Z[M]=M,Z[O]=O,Z[a+L]=JSON.parse(JSON.stringify(T)),Z}();