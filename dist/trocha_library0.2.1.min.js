/** @license trocha@0.2.1 - 2019-04-10
* Trocha.js 
* 
* This source code is licensed under the Mozillas Public license 2.0 found in the 
* LICENSE file in the root directory of this source tree. 
*/

function _get(e,t,r){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(e){_defineProperty(t,e,r[e])})}return t}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classPrivateFieldGet(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");var r=t.get(e);return r.get?r.get.call(e):r.value}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _wrapNativeSuper(e){var r="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(e){if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,t)}function t(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(t,e)})(e)}function isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function _construct(e,t,r){return(_construct=isNativeReflectConstruct()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&_setPrototypeOf(i,r.prototype),i}).apply(null,arguments)}function _isNativeFunction(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e){var v=function(e,t,r){throw new(function(e){function i(e,t,r){var n;return _classCallCheck(this,i),(n=_possibleConstructorReturn(this,_getPrototypeOf(i).call(this,o+t))).scope=e,n.value=r,n}return _inherits(i,_wrapNativeSuper(Error)),i}())(e,t,r)},i=function(e,t,r){console.warn(a+t,r||_,e||_)},_="",h="ROUTE",y="SCOPE",P="RESOURCE",g="ALIAS",O="COLON",t="BRACKETS",r={};r[t]="{".concat("Ñ","}"),r[O]=":".concat("Ñ");var b=function(t){return function(e){return(1<arguments.length&&void 0!==arguments[1]?arguments[1]:"Ñ").replace("Ñ",r[t].replace("Ñ",e))}},S="id",F="name",G="hide",w="type",C="alias",k="query",E="post",R="method",T="domain",m="idMode",j="justId",A="fragment",N="resource",U="parentId",D="defaultId",I="alwaysUrl",M="alwaysPost",L="path",n="list",H=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"$",t={};return t[e+S]=S,t.show={},t.edit={},t.new={},t[n]={},t.show[e+G]=!0,t.new[e+S]=!1,t[n][e+S]=!1,t[n][e+G]=!0,t},o="TrochaJS error: ",a="TrochaJS warning: ",Route=function(){function Route(e,t,r,n){var i=this,o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{},a=5<arguments.length?arguments[5]:void 0,l=6<arguments.length?arguments[6]:void 0,c=7<arguments.length?arguments[7]:void 0,s=8<arguments.length?arguments[8]:void 0,u=9<arguments.length?arguments[9]:void 0,f=10<arguments.length?arguments[10]:void 0;_classCallCheck(this,Route),W.set(this,{writable:!0,value:{parent:null,childs:{},SS:"$",alwaysPost:!1,alwaysUrl:!1,idMode:O,domain:"",post:"",pre:""}}),x.set(this,{writable:!0,value:function(e,t){var r=_classPrivateFieldGet(e,W).SS;return!!_classPrivateFieldGet(e,W).parent&&(_classPrivateFieldGet(e,W).parent[r+S]===t||_classPrivateFieldGet(e,x).call(e,_classPrivateFieldGet(e,W).parent,t))}}),B.set(this,{writable:!0,value:function(e,t,r,n){var i=n?"":_classPrivateFieldGet(e,W).SS;Object.defineProperty(e,i+t,{get:function(){return r?r():_classPrivateFieldGet(e,W)[t]},enumerable:!0,configurable:!1})}}),J.set(this,{writable:!0,value:function(t,r){var n=_classPrivateFieldGet(t,W).SS,e=function(e){_classPrivateFieldGet(t,W)[e]=r[n+e],delete r[n+e]};e(F),e(S),e(D),e(w),e(R),e(C),e(N),e(G),e(E),e(j),e(U),!1===r[_classPrivateFieldGet(t,W).parent[n+S]]&&e(_classPrivateFieldGet(t,W).parent[n+S]),_classPrivateFieldGet(t,B).call(t,t,F),_classPrivateFieldGet(t,B).call(t,t,S),_classPrivateFieldGet(t,B).call(t,t,R),_classPrivateFieldGet(t,B).call(t,t,"as",function(){return _classPrivateFieldGet(t,K).call(t,t)})}}),$.set(this,{writable:!0,value:function(e,t,r){var n=_classPrivateFieldGet(e,W).SS;_classPrivateFieldGet(e,W).childs[r]&&v(e,"Route already declare",r),[Route,Alias,Resource,Scope].forEach(function(e){e.is(t,n)&&(t=e.diggest(t,n,n))}),t[n+F]=r;var i={};i[h]=Route,i[void 0]=Route,i[g]=Alias,i[y]=Scope,i[P]=Resource;var o=new i[t[n+w]](e,t,n,_classPrivateFieldGet(e,W).root);_classPrivateFieldGet(e,W).childs[r]=o,_classPrivateFieldGet(e,B).call(e,e,r,function(){return _classPrivateFieldGet(e,W).childs[r]},!0)}}),z.set(this,{writable:!0,value:function(e,t,r){var n=_classPrivateFieldGet(e,W).SS;if(!r&&_classPrivateFieldGet(e,W)[w]===P){var i=_classPrivateFieldGet(e,W)[N];delete i[n+S],_classPrivateFieldGet(e,z).call(e,e,i,!0)}for(var o=Object.keys(t);o.length;){var a=o.pop();if(!1===t[a]&&_classPrivateFieldGet(e,x).call(e,e,a))_classPrivateFieldGet(e,W)[a]=!1;else if(_classPrivateFieldGet(e,$).call(e,e,t[a],a),_classPrivateFieldGet(e,W)[w]===y){var l=_objectSpread({},t[a]);l[n+U]=!1,_classPrivateFieldGet(e,$).call(e,_classPrivateFieldGet(e,W).parent,l,a)}}}}),K.set(this,{writable:!0,value:function(e){var t=_classPrivateFieldGet(e,W).SS;return _classPrivateFieldGet(e,W).parent[t+"as"]?"".concat(_classPrivateFieldGet(e,W).parent[t+"as"],"_").concat(_classPrivateFieldGet(e,W)[F]):_classPrivateFieldGet(e,W)[F]}}),_defineProperty(this,"_newRoute",function(e){if(e[w]=h,!Route.is(e,""))return!1;_classPrivateFieldGet(i,$).call(i,i,Route.diggest(e,_classPrivateFieldGet(i,W).SS,""),e[F])}),_defineProperty(this,"_newScope",function(e){if(e[w]=y,!Scope.is(e,""))return!1;_classPrivateFieldGet(i,$).call(i,i,Scope.diggest(e,_classPrivateFieldGet(i,W).SS,""),e[F])}),_defineProperty(this,"_newAlias",function(e){if(e[w]=g,!Alias.is(e,""))return!1;_classPrivateFieldGet(i,$).call(i,i,Alias.diggest(e,_classPrivateFieldGet(i,W).SS,""),e[F])}),_defineProperty(this,"_newResource",function(e){if(e[w]=P,!Resource.is(e,""))return!1;_classPrivateFieldGet(i,$).call(i,i,Resource.diggest(e,_classPrivateFieldGet(i,W).SS,""),e[F])}),_defineProperty(this,"toString",function(){return _classPrivateFieldGet(i,K).call(i,i)});var p=_classPrivateFieldGet(this,W).SS=r||"$";if(e||t&&t[p+F]&&t[p+w])_classPrivateFieldGet(this,W).parent=e,_classPrivateFieldGet(this,W).root=n,_classPrivateFieldGet(this,J).call(this,this,t),_classPrivateFieldGet(this,z).call(this,this,t);else{var d=function(e,t){return _classPrivateFieldGet(i,W)[e]=t||_classPrivateFieldGet(i,W)[e]};d(T,a),_classPrivateFieldGet(this,B).call(this,this,T),d(I,l),d(M,u),d(E,s),d("pre",c),d(m,f),_classPrivateFieldGet(this,W).root=_classPrivateFieldGet(this,W),delete this[L],_classPrivateFieldGet(this,B).call(this,this,P,function(){return H(p)}),_classPrivateFieldGet(this,z).call(this,this,o)}}return _createClass(Route,[{key:"path",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=1<arguments.length?arguments[1]:void 0,r=_classPrivateFieldGet(this,W),n=r.parent||{},i=r.root,o=r.SS,a=b(i[m]),l=_;if(void 0===r[F])return"";l=i[T]&&!1!==t.url&&(t.url||i[I])?i[T]:_,delete t.url,l+=i.pre&&(t.pre||t.ext)?i.pre:_,delete t.pre,l+=n[L]?n[L]({post:!1},function(){return!0}):_;var c,s=void 0!==t[G]?t[G]:r[G]||r[j]&&!1===r[D];if("function"==typeof e&&(c=e(r)),"string"==typeof c)l+=c;else{var u=a(r.id);if(!1!==t[j]&&r[j]&&r.id&&!1!==r[r.id])l+="/"+u;else{var f=!r.id||!1===t.id;l+=s?_:"/"+r[F],l+=f?_:"/"+u}}l+=i[E]&&!s&&!1!==t[E]&&(i[M]||r[E]||t[E]||t.ext)?i[E]:_,delete t[E];var p={};t[k]&&(p=JSON.parse(JSON.stringify(t[k])),delete t[k]);var d=_;return t[A]&&(d=t[A],delete t[A]),!n[o+S]||t[n[o+S]]||!1!==r.id&&!1!==t[U]&&!1!==r[U]||(l=l.replace(a(n[o+S],"/Ñ"),_)),Object.keys(r).forEach(function(e){if(!1===r[e]&&!t[e])return l=l.replace(a(e,"/Ñ"),_)}),Object.keys(t).forEach(function(e){l=!1===t[e]?l.replace(a(e,"/Ñ"),_):l.replace(a(e),t[e])}),Object.keys(p).forEach(function(r,n,i){0===n&&(l+="?"),Array.isArray(p[r])?p[r].forEach(function(e,t){return l+=encodeURIComponent(r)+"[]="+encodeURIComponent(e)+(p[r].length-1!==t||i.length-1!==n?"&":"")}):l+=encodeURIComponent(r)+"="+encodeURIComponent(p[r])+(i.length-1!==n?"&":"")}),d&&(l+="#"+encodeURIComponent(d)),l}}],[{key:"is",value:function(e,t){return e[t+w]===h||"object"===_typeof(e)&&void 0===e[t+w]}}]),Route}(),W=new WeakMap,x=new WeakMap,B=new WeakMap,J=new WeakMap,$=new WeakMap,z=new WeakMap,K=new WeakMap;_defineProperty(Route,"DEFAULT_METHOD","GET"),_defineProperty(Route,"diggest",function(t,r,n,i,e){if(!i||!e){var o={};return o[r+w]=h,o[r+R]=t[n+R]||Route.DEFAULT_METHOD,Route.diggest(t,r,n,o,[S,G,j,E,U]),Route._trimSelector(n,t,o),o}e.forEach(function(e){i[r+e]=t[n+e]})}),_defineProperty(Route,"_trimSelector",function(t,r,n){""!==t&&Object.keys(r).forEach(function(e){e.slice(0,2)!==t?n[e]=r[e]:i(Route,"Attribute not supported, skiped",e)})});var Alias=function(e){function Alias(){var e;_classCallCheck(this,Alias);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return _possibleConstructorReturn(this,(e=_getPrototypeOf(Alias)).call.apply(e,[this].concat(r)))}return _inherits(Alias,Route),_createClass(Alias,[{key:"path",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return _get(_getPrototypeOf(Alias.prototype),"path",this).call(this,a,function(e){var t=e.parent||{},r=e.root,n=b(r[m])(e.id,"/Ñ"),i=_;if(e.id&&a[j])i+=n;else{var o=!!e.id&&!1!==a[e.id];i+="Trocha"===t.constructor.name?_:"/",i+=a[G]?_:e[C],i+=o?n:_}return i})}}],[{key:"diggest",value:function(e,t,r){var n={};return n[t+w]=g,n[t+C]=e[r+C]||e,n[t+R]=e[r+R]||Route.DEFAULT_METHOD,Route.diggest(e,t,r,n,[S,E,U]),"string"!=typeof e&&Route._trimSelector(r,e,n),n}},{key:"is",value:function(e,t){return"string"==typeof e||e[t+w]===g&&e[t+C]}}]),Alias}(),Resource=function(e){function Resource(){var e;_classCallCheck(this,Resource);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return _possibleConstructorReturn(this,(e=_getPrototypeOf(Resource)).call.apply(e,[this].concat(r)))}return _inherits(Resource,Route),_createClass(Resource,[{key:"path",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length?arguments[1]:void 0;return _get(_getPrototypeOf(Resource.prototype),"path",this).call(this,e,function(e){return"function"==typeof t&&!0!==t()&&i(void 0,"Resource should not be used as a route"),!1})}}],[{key:"diggest",value:function(e,t,r){var n={};return n[t+w]=P,n[t+N]=e[r+N]||H(t),Route.diggest(e,t,r,n,[S]),Route._trimSelector(r,e,n),n}},{key:"is",value:function(e,t){return e[t+w]===P&&e[t+S]}}]),Resource}(),Scope=function(e){function Scope(){var e;_classCallCheck(this,Scope);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return _possibleConstructorReturn(this,(e=_getPrototypeOf(Scope)).call.apply(e,[this].concat(r)))}return _inherits(Scope,Route),_createClass(Scope,[{key:"path",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length?arguments[1]:void 0;return _get(_getPrototypeOf(Scope.prototype),"path",this).call(this,e,function(e){return"function"==typeof t&&!0!==t()&&v(void 0,"Scope is not printable a route"),!1})}}],[{key:"diggest",value:function(e,t,r){var n={};return n[t+w]=y,n[t+j]=!0,n[t+D]=e[r+D]||!1,Route.diggest(e,t,r,n,[S,G]),Route._trimSelector(r,e,n),n}},{key:"is",value:function(e,t){return"object"===_typeof(e)&&e[t+w]===y&&e[t+S]}}]),Scope}(),Trocha=function(e){function Trocha(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,Trocha),_possibleConstructorReturn(this,_getPrototypeOf(Trocha).call(this,null,null,e.customSelector,null,e.routes,e[T],e[I],e.pre,e[E],e[M],e[m]))}return _inherits(Trocha,Route),_createClass(Trocha,null,[{key:"ROUTE",get:function(){return h}},{key:"SCOPE",get:function(){return y}},{key:"RESOURCE",get:function(){return P}},{key:"ALIAS",get:function(){return g}},{key:"OPTIONS",get:function(){return"OPTIONS"}},{key:"GET",get:function(){return"GET"}},{key:"HEAD",get:function(){return"HEAD"}},{key:"POST",get:function(){return"POST"}},{key:"PUT",get:function(){return"PUT"}},{key:"PATCH",get:function(){return"PATCH"}},{key:"DELETE",get:function(){return"DELETE"}},{key:"TRACE",get:function(){return"TRACE"}},{key:"CONNECT",get:function(){return"CONNECT"}},{key:"BRACKETS",get:function(){return t}},{key:"COLON",get:function(){return O}},{key:"$RESOURCE",get:function(){return H()}}]),Trocha}();e.Trocha=Trocha,e.Route=Route,e.Alias=Alias,e.Resource=Resource,e.Scope=Scope}(this);